<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width">
    <title>Analytics Next Storage Demo</title>
    <link rel="stylesheet" href="index.css" >
    <script src="https://cdnjs.cloudflare.com/ajax/libs/uuid/8.1.0/uuidv4.min.js"></script>
    <script>
        const url = new URL(location.toString());
        const writeKey = url.searchParams.get('writeKey')
      !function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.invoked=!0;analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","debug","page","once","off","on","addSourceMiddleware","addIntegrationMiddleware","setAnonymousId","addDestinationMiddleware"];analytics.factory=function(e){return function(){var t=Array.prototype.slice.call(arguments);t.unshift(e);analytics.push(t);return analytics}};for(var e=0;e<analytics.methods.length;e++){var key=analytics.methods[e];analytics[key]=analytics.factory(key)}analytics.load=function(key,e){analytics._writeKey=key;var t=document.createElement("script");t.type="text/javascript";t.async=!0;t.src="https://cdn.segment.com/analytics-next/br/action_metrics_2/latest/standalone.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(t,n);analytics._loadOptions=e};;analytics.SNIPPET_VERSION="4.15.3";
        analytics.load(writeKey);
        analytics.ready(() => {
          console.log(window.analytics)
        })
        analytics.page();
        console.log('loading ajs');
      }}();
    </script>
  </head>

  <body>
    <div class="btn-container">
      <button id="track">Track</button>
      <button id="identify">Identify</button>
    </div>

    <script type="text/javascript">
      const trackBtn = document.getElementById('track');
      const identifyBtn = document.getElementById('identify');
      const userId = uuidv4();

      identifyBtn.addEventListener('click', () => {
        analytics.identify(userId, {
          email: 'christopher.radek@segment.com',
          name: 'Chris Radek'
        });
      });

      trackBtn.addEventListener('click', () => {
        analytics.track('test tracking', {
          foo: 'bar'
        });
      })
    </script>


  </body>
</html>
